import{G as h}from"./GuideItem-b9ea473c.js";import{u as w,r as d,a as m}from"./index-ad0dd498.js";import{_ as f,m as b,r as v,o as n,c as l,a as i,h as G,v as g,F as c,e as _,b as o,i as y,u as j,f as x}from"./index-4e58868f.js";const A={setup(){return{v$:w({$autoDirty:!0})}},data(){return{topic:{name:"",guides:[]},allGuides:[{name:"Former les cadres supérieurs",url:"www.majrh.fr/former-cadres-superieurs",image:"www.temp.fr"},{name:"Savoir quand former un collaborateur",url:"www.majrh.fr/savoir-quand-former",image:"www.temp.fr"},{name:"Discriminations : les biais en recrutement",url:"www.majrh.fr/discrimination-biais-recrutement",image:"www.temp.fr"},{name:"Onboarding en 5 étapes",url:"www.majrh.fr/onboarding-5-etapes",image:"www.temp.fr"}],availableGuides:[{name:"Former les cadres supérieurs",url:"www.majrh.fr/former-cadres-superieurs",image:"www.temp.fr"},{name:"Savoir quand former un collaborateur",url:"www.majrh.fr/savoir-quand-former",image:"www.temp.fr"},{name:"Discriminations : les biais en recrutement",url:"www.majrh.fr/discrimination-biais-recrutement",image:"www.temp.fr"},{name:"Onboarding en 5 étapes",url:"www.majrh.fr/onboarding-5-etapes",image:"www.temp.fr"}]}},validations(){return{topic:{name:{required:d,maxLength:m(100)},guides:{required:d,maxLength:m(50)}}}},components:{GuideItem:h},computed:{...b(j,["token"]),invalidForm(){return this.topic.guides<4||!this.topic.name}},created(){this.addGuide()},methods:{addGuide(){this.updateAvailableGuides(),this.topic.guides.push({name:"",url:"",image:""})},deleteGuide(e){this.topic.guides.splice(e,1),this.updateAvailableGuides()},enableTooltip(e){const t=document.getElementById(e);bootstrap.Tooltip.getOrCreateInstance(t).enable()},updateAvailableGuides(){this.availableGuides=[];const e=this.topic.guides.map(a=>a.url);this.allGuides.filter(a=>!e.includes(a.url)).forEach(a=>{this.availableGuides.push(a)})},guidesFormat(){this.topic.guides.forEach(e=>{if(!e.id){const t=this.allGuides.filter(a=>e.url===a.url);e.id=t[0].id}e.noUpdate&&(delete e.name,delete e.url,delete e.image),delete e.noUpdate})},async createTopic(){await this.v$.$validate()?(this.$toast.success("toast-app",`Le guide ${this.topic.name} a bien été créé`),this.$router.push({name:"themes"})):this.$toast.error("toast-app","Les informations de votre thème ne sont pas valides")},async initGuides(){const e={Authorization:`Bearer ${this.token}`},t=await this.$http.get("/guides",{headers:e});t.status===204||t.status===200?(this.allGuides=t.body,this.availableGuides=t.body):console.error(t)}}},q=i("h1",null,"Créer un thème",-1),L={class:"outlined my-4 p-4"},T={class:"row"},F={class:"col-12"},U=i("label",{for:"name",class:"fs-5"},"Nom du thème",-1),$=i("div",{class:"cols-12 my-4"},[i("p",null,[o("Veuillez ajouter entre 5 et 50 fiches pratiques associées à ce thème."),i("br"),o(" Attention au choix de l’image et du nom de la fiche, ce sont les informations que les utilisateurs du quizz verront !")])],-1),k=i("i",{class:"bi bi-plus-circle"},null,-1),C={class:"align-items-end flex-column row"},D=["disabled"],V=i("i",{class:"bi bi-plus-circle"},null,-1);function B(e,t,a,E,I,s){const p=v("GuideItem");return n(),l(c,null,[q,i("form",{class:"my-5",onSubmit:t[2]||(t[2]=y((...r)=>s.createTopic&&s.createTopic(...r),["prevent"]))},[i("div",L,[i("div",T,[i("div",F,[U,G(i("input",{name:"name",id:"name",type:"text",class:"form-control",placeholder:"Ex : recrutement","onUpdate:modelValue":t[0]||(t[0]=r=>e.topic.name=r)},null,512),[[g,e.topic.name]])]),$]),(n(!0),l(c,null,_(e.topic.guides,(r,u)=>(n(),l("div",{class:"row py-3 my-5 d-flex",key:u},[x(p,{index:u,guide:r,availableGuides:e.availableGuides,allGuides:e.allGuides,onDeleteGuide:s.deleteGuide,onUpdateGuidesList:s.updateAvailableGuides},null,8,["index","guide","availableGuides","allGuides","onDeleteGuide","onUpdateGuidesList"])]))),128)),i("button",{class:"btn secundary-button mt-2",onClick:t[1]||(t[1]=(...r)=>s.addGuide&&s.addGuide(...r)),type:"button"},[k,o(" Ajouter une fiche ")])]),i("div",C,[i("button",{class:"btn primary-button mt-2 col-12 col-md-3",type:"submit",disabled:s.invalidForm},[V,o(" Créer un thème ")],8,D)])],32)],64)}const O=f(A,[["render",B]]);export{O as default};
